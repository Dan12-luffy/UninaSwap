<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.shape.Rectangle?>

<BorderPane maxHeight="-Infinity" maxWidth="-Infinity" prefHeight="700.0" prefWidth="1000.0" styleClass="product-details-container" stylesheets="@../guiCSS/productDetailsInterface.css" xmlns="http://javafx.com/javafx/23.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.uninaswap.controllers.ProductDetailsController">

    <top>
        <VBox spacing="0">
            <!-- Banner superiore -->
            <HBox alignment="CENTER_LEFT" maxHeight="35.0" styleClass="top-banner">
                <Label styleClass="welcome-text" text="Dettagli prodotto - UninaSwap" />
                <Region HBox.hgrow="ALWAYS" />
                <Button fx:id="favoriteButton" onAction="#toggleFavorite" styleClass="icon-button" text="❤ Preferiti" />
                <padding>
                    <Insets bottom="5.0" left="15.0" right="15.0" top="5.0" />
                </padding>
            </HBox>

            <!-- Header principale -->
            <HBox alignment="CENTER" minHeight="60.0" styleClass="main-header">
                <!-- Logo container -->
                <HBox alignment="CENTER_LEFT" minWidth="200.0" styleClass="logo-container">
                    <StackPane styleClass="logo-badge">
                        <Rectangle height="50.0" styleClass="logo-background" width="180.0" />
                        <ImageView fx:id="logoImage" fitHeight="40.0" preserveRatio="true" styleClass="logo-image">
                            <Image url="@../images/uninaswap_logo.png" />
                        </ImageView>
                    </StackPane>
                </HBox>

                <!-- Titolo centrale -->
                <HBox alignment="CENTER" styleClass="title-container" HBox.hgrow="ALWAYS">
                    <Label fx:id="headerTitleLabel" styleClass="header-title" text="Visualizza Prodotto" />
                </HBox>

                <!-- Pulsanti azione -->
                <HBox alignment="CENTER_RIGHT" spacing="15">
                    <Button fx:id="backButton" onAction="#onBackButtonClicked" styleClass="back-button" text="← Indietro" />
                </HBox>
                <padding>
                    <Insets bottom="8.0" left="15.0" right="15.0" top="8.0" />
                </padding>
            </HBox>

            <!-- Breadcrumbs migliorati -->
            <HBox alignment="CENTER_LEFT" styleClass="breadcrumb-bar">
                <HBox alignment="CENTER_LEFT" spacing="8" styleClass="breadcrumb-container">
                    <Button fx:id="homeBreadcrumb" styleClass="breadcrumb-link" text="🏠 Home" />
                    <Label styleClass="breadcrumb-separator" text="›" />
                    <Button fx:id="categoryBreadcrumb" styleClass="breadcrumb-link" text="📚 Categoria" />
                    <Label styleClass="breadcrumb-separator" text="›" />
                    <Label fx:id="productTitleBreadcrumb" styleClass="breadcrumb-current" text="Prodotto Corrente" />
                </HBox>
                <padding>
                    <Insets bottom="10.0" left="15.0" right="15.0" top="10.0" />
                </padding>
            </HBox>
        </VBox>
    </top>

    <center>
        <ScrollPane fitToWidth="true" styleClass="content-scroll-pane">
            <VBox spacing="20.0" styleClass="content-area">
                <padding>
                    <Insets bottom="20.0" left="20.0" right="20.0" top="15.0" />
                </padding>
                <children>
                    <!-- Container principale prodotto -->
                    <HBox spacing="25.0" styleClass="main-product-container">
                        <!-- Sezione immagine -->
                        <VBox spacing="10" styleClass="image-section">
                            <!-- Immagine principale -->
                            <StackPane styleClass="main-image-container" translateY="-113.0">
                                <ImageView fx:id="productImageView" fitHeight="280.0" fitWidth="280.0" styleClass="product-main-image" />
                                <VBox alignment="TOP_RIGHT" styleClass="image-badges">
                                    <Label fx:id="conditionBadge" styleClass="condition-badge" text="Ottime Condizioni" />
                                    <Label fx:id="typeBadge" styleClass="type-badge" text="N/A" />
                                </VBox>
                            </StackPane>

                            <!-- Placeholder per immagini secondarie -->
                            <HBox alignment="CENTER" spacing="8" styleClass="thumbnail-container">
                                <ImageView fitHeight="45.0" fitWidth="45.0" styleClass="thumbnail-image" />
                                <ImageView fitHeight="45.0" fitWidth="45.0" styleClass="thumbnail-image" />
                                <ImageView fitHeight="45.0" fitWidth="45.0" styleClass="thumbnail-image" />
                            </HBox>
                        </VBox>

                        <!-- Sezione informazioni -->
                        <VBox spacing="18.0" styleClass="info-section" HBox.hgrow="ALWAYS">
                            <!-- Titolo e prezzo -->
                            <VBox spacing="10" styleClass="title-price-section">
                                <Label fx:id="productTitleLabel" styleClass="product-title" text="N/A" />
                                <HBox alignment="CENTER_LEFT" spacing="15">
                                    <Label fx:id="priceLabel" styleClass="product-price" text="€0.00" />
                                </HBox>
                            </VBox>

                            <!-- Informazioni venditore -->
                            <VBox spacing="10" styleClass="seller-section">
                                <Label styleClass="section-title" text="👤 Venditore" />
                                <HBox alignment="CENTER_LEFT" spacing="10" styleClass="seller-info">
                                    <StackPane styleClass="seller-avatar">
                                        <Label styleClass="avatar-placeholder" text="👤" />
                                    </StackPane>
                                    <VBox spacing="3">
                                        <Label fx:id="sellerLabel" styleClass="seller-name" text="Nome Venditore" />
                                        <Label fx:id="sellerRatingLabel" styleClass="seller-rating" text="⭐⭐⭐⭐⭐ (4.8/5)" />
                                        <Label fx:id="sellerJoinedLabel" styleClass="seller-joined" text="Membro dal 2022" />
                                    </VBox>
                                </HBox>
                            </VBox>

                            <!-- Dettagli prodotto -->
                            <VBox spacing="10" styleClass="details-section">
                                <Label styleClass="section-title" text="📋 Dettagli" />
                                <GridPane hgap="20" styleClass="details-grid" vgap="10">
                                    <columnConstraints>
                                        <ColumnConstraints hgrow="NEVER" maxWidth="120.0" minWidth="100.0" />
                                        <ColumnConstraints hgrow="ALWAYS" />
                                    </columnConstraints>
                                    <rowConstraints>
                                        <RowConstraints />
                                        <RowConstraints />
                                        <RowConstraints />
                                        <RowConstraints />
                                    </rowConstraints>

                                    <children>
                                        <Label styleClass="detail-label" text="Categoria:" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                                        <Label fx:id="categoryLabel" styleClass="detail-value" text="N/A" GridPane.columnIndex="1" GridPane.rowIndex="0" />

                                        <Label styleClass="detail-label" text="Condizioni:" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                                        <Label fx:id="conditionLabel" styleClass="detail-value" text="N/A" GridPane.columnIndex="1" GridPane.rowIndex="1" />

                                        <Label styleClass="detail-label" text="Disponibilità:" GridPane.columnIndex="0" GridPane.rowIndex="2" />
                                        <Label fx:id="availabilityLabel" styleClass="detail-value available" text="N/A" GridPane.columnIndex="1" GridPane.rowIndex="2" />

                                        <Label styleClass="detail-label" text="Pubblicato:" GridPane.columnIndex="0" GridPane.rowIndex="3" />
                                        <Label fx:id="dateLabel" styleClass="detail-value" text="N/A" GridPane.columnIndex="1" GridPane.rowIndex="3" />
                                    </children>
                                </GridPane>
                            </VBox>

                            <!-- Pulsanti azione principali -->
                            <VBox fx:id="actionButtonsVbox" spacing="10" styleClass="action-section">
                                <HBox alignment="CENTER" spacing="10" styleClass="primary-actions">
                                    <Button fx:id="actionButton" defaultButton="true" onAction="#onBuyButtonClicked" styleClass="buy-button" text="Acquista Ora" HBox.hgrow="ALWAYS" />
                                    <Button fx:id="offerButton" onAction="#onOfferButtonClicked" styleClass="offer-button" text="💰 Fai Offerta" HBox.hgrow="ALWAYS" />
                                </HBox>
                            </VBox>
                        </VBox>
                    </HBox>

                    <!-- Sezione descrizione -->
                    <VBox spacing="15" styleClass="description-section">
                        <Label styleClass="section-title-large" text="Descrizione Dettagliata" />
                        <VBox styleClass="description-container">
                            <TextArea fx:id="descriptionTextArea" editable="false" prefHeight="100.0" styleClass="description-text" wrapText="true" />
                        </VBox>
                    </VBox>

                    <!-- Sezione informazioni aggiuntive -->
                    <VBox spacing="15" styleClass="additional-info-section">
                        <Label styleClass="section-title-large" text="Informazioni Consegna" />
                        <GridPane hgap="30" styleClass="delivery-grid" vgap="15">
                            <columnConstraints>
                                <ColumnConstraints hgrow="ALWAYS" />
                                <ColumnConstraints hgrow="ALWAYS" />
                            </columnConstraints>
                            <rowConstraints>
                                <RowConstraints />
                                <RowConstraints />
                            </rowConstraints>

                            <children>
                                <VBox spacing="8" styleClass="delivery-info-card" GridPane.columnIndex="0" GridPane.rowIndex="0">
                                    <Label styleClass="card-title" text="Luogo di Ritiro" />
                                    <Label fx:id="locationLabel" styleClass="card-content" text="Facoltà di Ingegneria" />
                                </VBox>

                                <VBox spacing="8" styleClass="delivery-info-card" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                    <Label styleClass="card-title" text="Modalità Consegna" />
                                    <Label fx:id="deliveryLabel" styleClass="card-content" text="Consegna a mano, orari flessibili" />
                                </VBox>
                            </children>
                        </GridPane>
                    </VBox>

                    <!-- Footer con informazioni di sicurezza -->
                    <VBox spacing="15" styleClass="safety-footer">
                        <Separator styleClass="main-separator" />
                        <HBox alignment="CENTER" spacing="30" styleClass="safety-info">
                            <VBox alignment="CENTER" spacing="5" styleClass="safety-item">
                                <Label styleClass="safety-icon" text="🔒" />
                                <Label styleClass="safety-text" text="Transazioni Sicure" />
                            </VBox>
                            <VBox alignment="CENTER" spacing="5" styleClass="safety-item">
                                <Label styleClass="safety-icon" text="✅" />
                                <Label styleClass="safety-text" text="Profili Verificati" />
                            </VBox>
                            <VBox alignment="CENTER" spacing="5" styleClass="safety-item">
                                <Label styleClass="safety-icon" text="🛡️" />
                                <Label styleClass="safety-text" text="Supporto 24/7" />
                            </VBox>
                        </HBox>
                    </VBox>
                </children>
            </VBox>
        </ScrollPane>
    </center>
</BorderPane>
