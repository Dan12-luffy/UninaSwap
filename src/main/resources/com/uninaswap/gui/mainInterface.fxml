<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.CheckBox?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.RadioButton?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.Slider?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.control.TitledPane?>
<?import javafx.scene.control.ToggleButton?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.shape.Circle?>
<?import javafx.scene.shape.Rectangle?>

<BorderPane maxHeight="-Infinity" maxWidth="-Infinity" prefHeight="800.0" prefWidth="1200.0" styleClass="main-container" stylesheets="@../guiCSS/mainInterface.css" xmlns="http://javafx.com/javafx/23.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.uninaswap.controllers.MainController">

    <!-- Header principale compatto -->
    <top>
        <VBox spacing="0">
            <!-- Banner superiore più compatto -->
            <HBox alignment="CENTER_RIGHT" maxHeight="35.0" styleClass="top-banner">
                <Label styleClass="welcome-text" text="Benvenuto in UninaSwap!" />
                <Region HBox.hgrow="ALWAYS" />

                <!-- Container per il pulsante notifiche con badge -->
                <StackPane>
                    <!-- Pulsante notifiche ottimizzato -->
                    <Button fx:id="notificationButton" alignment="CENTER" contentDisplay="CENTER" minHeight="29.0" minWidth="123.0" onAction="#onNotificationButtonClicked" prefHeight="29.0" prefWidth="123.0" styleClass="icon-button" text="Notifiche" translateX="9.0" />

                    <!-- Badge notifiche posizionato in alto a destra -->
                    <StackPane fx:id="notificationBadge" maxHeight="-Infinity" maxWidth="-Infinity" minHeight="-Infinity" minWidth="-Infinity" mouseTransparent="true" prefHeight="29.0" prefWidth="133.0" translateX="9.0" translateY="-8.0" visible="true" StackPane.alignment="TOP_RIGHT">
                        <Circle fill="#ff4444" mouseTransparent="true" radius="10.0" stroke="#ffffff" strokeWidth="1.0" translateX="45.0" translateY="8.0" />
                        <Label fx:id="notificationCountLabel" mouseTransparent="true" styleClass="notification-badge-text" text="3" textFill="white" translateX="45.0" translateY="8.0" />
                    </StackPane>
                </StackPane>

                <padding>
                    <Insets bottom="5.0" left="15.0" right="15.0" top="5.0" />
                </padding>
            </HBox>

            <!-- Header principale ottimizzato -->
            <HBox alignment="CENTER" minHeight="60.0" styleClass="main-header">
                <!-- Logo container migliorato -->
                <HBox alignment="CENTER_LEFT" minWidth="200.0" styleClass="logo-container">
                    <StackPane styleClass="logo-badge">
                        <!-- Rettangolo bianco con angoli arrotondati e ombra leggera -->
                        <Rectangle height="50.0" styleClass="logo-background" width="180.0" />

                        <!-- Logo immagine -->
                        <ImageView fx:id="logoImage" fitHeight="40.0" preserveRatio="true" styleClass="logo-image">
                            <Image url="@../images/uninaswap_logo.png" />
                        </ImageView>
                    </StackPane>
                </HBox>

                <HBox alignment="CENTER" styleClass="search-container" HBox.hgrow="ALWAYS">
                    <TextField fx:id="searchField" promptText="Cosa stai cercando oggi?" styleClass="search-field" HBox.hgrow="ALWAYS" />
                    <Button fx:id="searchButton" onAction="#onSearchButtonClicked" styleClass="search-button" text="Cerca" />
                </HBox>

                <HBox alignment="CENTER_RIGHT" spacing="15">
                    <Button fx:id="wishlistButton" styleClass="nav-button" text="Preferiti" />
                    <Button fx:id="messagesButton" styleClass="nav-button" text="Messaggi" />
                    <Button fx:id="sellButton" onAction="#onSellButtonClicked" styleClass="sell-button" text="Vendi Articolo" />
                </HBox>
                <padding>
                    <Insets bottom="8.0" left="15.0" right="15.0" top="8.0" />
                </padding>
            </HBox>

            <!-- Barra di navigazione categorie -->
            <HBox spacing="5" styleClass="category-nav">
                <ToggleButton fx:id="allCategoryButton" selected="true" styleClass="category-button" text="Tutto" />
                <ToggleButton fx:id="booksCategoryButton" styleClass="category-button" text="Libri" />
                <ToggleButton fx:id="notesCategoryButton" styleClass="category-button" text="Appunti" />
                <ToggleButton fx:id="electronicCategoryButton" styleClass="category-button" text="Elettronica" />
                <ToggleButton fx:id="furnitureCategoryButton" styleClass="category-button" text="Arredamento" />
                <ToggleButton fx:id="clothingCategoryButton" styleClass="category-button" text="Abbigliamento" />
                <ToggleButton fx:id="otherCategoryButton" styleClass="category-button" text="Altro" />
                <padding>
                    <Insets bottom="5.0" left="15.0" right="15.0" top="5.0" />
                </padding>
            </HBox>
        </VBox>
    </top>

    <!-- Pannello filtri ottimizzato con ScrollPane -->
    <left>
        <ScrollPane fitToWidth="true" styleClass="filters-scroll-pane">
            <VBox prefWidth="250.0" styleClass="filters-panel">
                <HBox alignment="CENTER_LEFT" styleClass="filters-header">
                    <Label styleClass="filters-title" text="Filtri" />
                    <Region HBox.hgrow="ALWAYS" />
                    <Button fx:id="resetFilters" onAction="#onResetFiltersClicked" styleClass="text-button" text="Azzera" />
                </HBox>

                <!-- Filtri principali - tutti chiusi di default -->
                <TitledPane expanded="false" styleClass="filter-section" text="Stato">
                    <VBox spacing="8">
                        <RadioButton fx:id="allConditionsRadio" selected="true" text="Tutti gli stati" />
                        <RadioButton fx:id="likeNewRadio" text="Come nuovo" />
                        <RadioButton fx:id="excellentRadio" text="Ottime condizioni" />
                        <RadioButton fx:id="goodRadio" text="Buone condizioni" />
                    </VBox>
                </TitledPane>

                <TitledPane expanded="false" styleClass="filter-section" text="Prezzo">
                    <VBox spacing="8">
                        <HBox alignment="CENTER">
                            <Label fx:id="minPriceLabel" text="0€" />
                            <Region HBox.hgrow="ALWAYS" />
                            <Label fx:id="maxPriceLabel" text="200€" />
                        </HBox>
                        <Slider fx:id="priceSlider" max="200" min="0" onDragDetected="#sliderPriceSelection" onMouseClicked="#sliderPriceSelection" value="100" />
                        <HBox alignment="CENTER" spacing="8" styleClass="price-inputs">
                            <TextField fx:id="minPriceField" prefWidth="60" promptText="Min" />
                            <Label text="-" />
                            <TextField fx:id="maxPriceField" prefWidth="60" promptText="Max" />
                            <Button fx:id="applyPriceButton" onAction="#onApplyPriceButtonClicked" styleClass="mini-button" text="OK" />
                        </HBox>
                    </VBox>
                </TitledPane>
                <TitledPane expanded="false" styleClass="filter-section" text="Tipologia (Nome da migliorare)">
                    <content>
                        <VBox spacing="8">
                            <children>
                                <CheckBox fx:id="saleCheck" text="Vendita" />
                                <CheckBox fx:id="swapCheck" text="Scambio" />
                                <CheckBox fx:id="giftCheck" text="Regalo" />
                            </children>
                        </VBox>
                    </content>
                </TitledPane>

                <TitledPane expanded="false" styleClass="filter-section" text="Facoltà">
                    <VBox spacing="8">
                        <CheckBox fx:id="computerScienceCheck" text="Informatica" />
                        <CheckBox fx:id="scienceCheck" text="Scienze" />
                        <CheckBox fx:id="mathCheck" text="Matematica" />
                        <CheckBox fx:id="economyCheck" text="Economia" />
                        <CheckBox fx:id="artCheck" text="Arte" />
                        <CheckBox fx:id="medicineCheck" text="Medicina" />
                        <CheckBox fx:id="biologyCheck" text="Biologia" />
                        <CheckBox fx:id="philosophyCheck" text="Filosofia" />
                        <CheckBox fx:id="geographyCheck" text="Geografia" />
                        <CheckBox fx:id="psichologyCheck" text="Psicologia" />
                        <CheckBox fx:id="chemistryCheck" text="Chimica" />
                        <CheckBox fx:id="astronomyCheck" text="Astronomia" />
                        <CheckBox fx:id="tourismCheck" text="Turismo" />
                        <CheckBox fx:id="linguisticsCheck" text="Linguistica" />
                        <CheckBox fx:id="musicCheck" text="Musica" />
                    </VBox>
                </TitledPane>

                <!-- Pulsante Applica -->
                <Button fx:id="applyFilters" onAction="#onApplyFiltersClicked" styleClass="apply-button" text="Applica Filtri" />

                <Separator />

                <!-- Sezione utente compatta -->
                <VBox styleClass="user-section">
                    <Label fx:id="usernameLabel" styleClass="user-greeting" text="Ciao, Mario!" />
                    <HBox spacing="8">
                        <Button fx:id="profileButton" maxWidth="Infinity" onAction="#onProfileButtonClicked" styleClass="user-button" text="Mio Profilo" HBox.hgrow="ALWAYS" />
                        <Button fx:id="logoutButton" maxWidth="Infinity" onAction="#onLogoutButtonClicked" styleClass="logout-button" text="Logout" HBox.hgrow="ALWAYS" />
                    </HBox>
                </VBox>
                <padding>
                    <Insets bottom="15.0" left="15.0" right="15.0" top="15.0" />
                </padding>
            </VBox>
        </ScrollPane>
    </left>

    <!-- Area principale contenente gli articoli -->
    <center>
        <VBox styleClass="content-area">
            <!-- Intestazione risultati -->
            <HBox alignment="CENTER_LEFT" styleClass="results-header">
                <Label fx:id="resultsCountLabel" styleClass="results-title" text="Caricamento articoli..." />
                <Region HBox.hgrow="ALWAYS" />
                <ComboBox fx:id="sortComboBox" prefWidth="150.0" promptText="Più recenti" styleClass="sort-dropdown" />
                <ToggleButton fx:id="listViewButton" selected="true" styleClass="view-toggle" text="Lista" />
                <ToggleButton fx:id="gridViewButton" styleClass="view-toggle" text="Griglia" />
            </HBox>

            <!-- Contenitore principale degli articoli completamente vuoto -->
            <ScrollPane fx:id="itemsScrollPane" fitToWidth="true" maxWidth="1.7976931348623157E308" styleClass="items-scroll" VBox.vgrow="ALWAYS">
                <VBox spacing="5" styleClass="items-container">
                    <!-- GridPane vuoto dove verranno caricate le inserzioni tramite DAO -->
                    <GridPane fx:id="itemsGrid" hgap="15" styleClass="items-grid" vgap="8">
                        <columnConstraints>
                            <ColumnConstraints hgrow="NEVER" minWidth="100.0" prefWidth="100.0" />
                            <ColumnConstraints hgrow="ALWAYS" />
                            <ColumnConstraints hgrow="NEVER" minWidth="100.0" prefWidth="100.0" />
                            <ColumnConstraints hgrow="NEVER" minWidth="60.0" prefWidth="60.0" />
                        </columnConstraints>
                        <!-- Inserzioni caricate dai DAO -->
                    </GridPane>

                    <!-- Pulsante carica altri risultati -->
                    <Button fx:id="loadMoreButton" maxHeight="1.7976931348623157E308" maxWidth="1.7976931348623157E308" minHeight="-Infinity" minWidth="-Infinity" prefHeight="38.0" prefWidth="854.0" styleClass="load-more-button" text="Carica altri risultati" />
                </VBox>
            </ScrollPane>
        </VBox>
    </center>
</BorderPane>
