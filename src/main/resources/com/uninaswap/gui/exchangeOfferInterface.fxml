<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.shape.Rectangle?>

<BorderPane maxHeight="-Infinity" maxWidth="-Infinity" prefHeight="855.0" prefWidth="1200.0" styleClass="exchange-container" stylesheets="@../guiCSS/exchangeInterface.css" xmlns="http://javafx.com/javafx/23.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.uninaswap.controllers.ExchangeOfferController">

    <top>
        <VBox spacing="0">
            <!-- Banner superiore -->
            <HBox alignment="CENTER_LEFT" maxHeight="35.0" styleClass="top-banner">
                <Label styleClass="welcome-text" text="Proposta di Scambio UninaSwap" />
                <Region HBox.hgrow="ALWAYS" />
                <padding>
                    <Insets bottom="5.0" left="15.0" right="15.0" top="5.0" />
                </padding>
            </HBox>

            <!-- Header principale -->
            <HBox alignment="CENTER" minHeight="60.0" styleClass="main-header">
                <!-- Logo container -->
                <HBox alignment="CENTER_LEFT" minWidth="200.0" styleClass="logo-container">
                    <StackPane styleClass="logo-badge">
                        <Rectangle height="50.0" styleClass="logo-background" width="180.0" />
                        <ImageView fx:id="logoImage" fitHeight="40.0" preserveRatio="true" styleClass="logo-image">
                            <Image url="@../images/uninaswap_logo.png" />
                        </ImageView>
                    </StackPane>
                </HBox>

                <!-- Titolo centrale -->
                <HBox alignment="CENTER" styleClass="title-container" HBox.hgrow="ALWAYS">
                    <Label styleClass="header-title" text="Proposta di Scambio" />
                </HBox>

                <!-- Pulsante indietro -->
                <HBox alignment="CENTER_RIGHT" spacing="15">
                    <Button fx:id="backButton" onAction="#goBack" styleClass="back-button" text="← Indietro" />
                </HBox>
                <padding>
                    <Insets bottom="8.0" left="15.0" right="15.0" top="8.0" />
                </padding>
            </HBox>
        </VBox>
    </top>

    <center>
        <ScrollPane fitToWidth="true" styleClass="content-scroll-pane">
            <VBox maxHeight="-Infinity" minHeight="-Infinity" prefHeight="1328.0" prefWidth="1188.0" spacing="25.0" styleClass="content-area">
                <padding>
                    <Insets bottom="25.0" left="25.0" right="25.0" top="20.0" />
                </padding>
                <children>
                    <!-- Sezione principale scambio -->
                    <HBox spacing="20.0" styleClass="exchange-main-container">
                        <!-- Colonna sinistra - I tuoi prodotti -->
                        <VBox spacing="15" styleClass="your-products-section" HBox.hgrow="ALWAYS">
                            <Label styleClass="section-title" text="🎒 I Tuoi Prodotti da Scambiare" />
                            <Label styleClass="section-subtitle" text="Seleziona uno o più prodotti da proporre nello scambio" />

                            <ScrollPane fitToWidth="true" prefHeight="400.0" styleClass="products-scroll-pane">
                                <VBox fx:id="yourProductsContainer" spacing="10" styleClass="products-container">
                                    <!-- I prodotti dell'utente verranno caricati qui dinamicamente -->
                                    <Label styleClass="placeholder-text" text="I tuoi prodotti disponibili per lo scambio appariranno qui" />
                                </VBox>
                            </ScrollPane>

                            <!-- Riepilogo selezione -->
                            <VBox spacing="8" styleClass="selection-summary">
                                <Label styleClass="summary-title" text="📋 Riepilogo Selezione" />
                                <HBox alignment="CENTER_LEFT" spacing="10" styleClass="summary-item">
                                    <Label styleClass="summary-label" text="Prodotti selezionati:" />
                                    <Label fx:id="selectedCountLabel" styleClass="summary-value" text="0" />
                                </HBox>
                                <HBox alignment="CENTER_LEFT" spacing="10" styleClass="summary-item">
                                    <Label styleClass="summary-label" text="Valore totale:" />
                                    <Label fx:id="totalValueLabel" styleClass="summary-value" text="€0.00" />
                                </HBox>
                            </VBox>
                        </VBox>

                        <!-- Colonna centrale - Icona scambio -->
                        <VBox alignment="CENTER" spacing="10" styleClass="exchange-symbol-section">
                            <StackPane styleClass="exchange-icon-container">
                                <ImageView fitHeight="80.0" fitWidth="80.0" preserveRatio="true" styleClass="exchange-icon">
                                    <Image url="@../images/swapArrows.png" />
                                </ImageView>
                            </StackPane>
                            <Label styleClass="exchange-label" text="Scambio" />
                        </VBox>

                        <!-- Colonna destra - Prodotto desiderato -->
                        <VBox prefHeight="663.0" prefWidth="433.0" spacing="15" styleClass="desired-product-section" HBox.hgrow="ALWAYS">
                            <Label styleClass="section-title" text="🎯 Prodotto Desiderato" />
                            <Label styleClass="section-subtitle" text="Il prodotto che vuoi ottenere in cambio" />

                            <VBox prefHeight="444.0" prefWidth="444.0" spacing="15" styleClass="desired-product-card">
                                <StackPane maxHeight="-Infinity" maxWidth="-Infinity" minHeight="-Infinity" minWidth="-Infinity" prefHeight="292.0" prefWidth="320.0" styleClass="desired-image-container" translateX="75.0">
                                    <ImageView fx:id="desiredProductImageView" fitHeight="272.0" fitWidth="280.0" preserveRatio="true" styleClass="desired-product-image" />
                                </StackPane>

                                <VBox spacing="8" styleClass="desired-product-info">
                                    <Label fx:id="desiredProductNameLabel" styleClass="desired-product-name" text="Nome Prodotto" />
                                    <Label fx:id="desiredProductDescriptionLabel" styleClass="desired-product-description" text="Descrizione del prodotto desiderato..." wrapText="true" />

                                    <HBox alignment="CENTER_LEFT" spacing="10" styleClass="desired-price-container">
                                        <Label styleClass="price-label" text="Valore:" />
                                        <Label fx:id="desiredProductPriceLabel" styleClass="price-value" text="€0.00" />
                                    </HBox>

                                    <HBox alignment="CENTER_LEFT" spacing="10" styleClass="desired-owner-container">
                                        <Label styleClass="owner-label" text="Proprietario:" />
                                        <Label fx:id="desiredProductOwnerLabel" styleClass="owner-value" text="Nome Utente" />
                                    </HBox>
                                </VBox>
                            </VBox>
                        </VBox>
                    </HBox>

                    <!-- Separatore -->
                    <Separator styleClass="main-separator" />

                    <!-- Sezione calcolo differenza -->
                    <VBox spacing="15" styleClass="difference-calculation">
                        <Label styleClass="calculation-title" text="💰 Calcolo dello Scambio" />

                        <GridPane hgap="20" styleClass="calculation-grid" vgap="12">
                            <columnConstraints>
                                <ColumnConstraints hgrow="NEVER" minWidth="150.0" />
                                <ColumnConstraints hgrow="ALWAYS" />
                                <ColumnConstraints hgrow="NEVER" minWidth="100.0" />
                            </columnConstraints>
                            <rowConstraints>
                                <RowConstraints />
                                <RowConstraints />
                                <RowConstraints />
                                <RowConstraints />
                            </rowConstraints>

                            <children>
                                <Label styleClass="calc-label" text="Valore del prodotto desiderato:" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                                <Label fx:id="desiredValueLabel" styleClass="calc-value" text="€0.00" GridPane.columnIndex="2" GridPane.rowIndex="0" />

                                      <Label styleClass="calc-label" text="Valore dei tuoi prodotti:" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                                <Label fx:id="yourTotalValueLabel" styleClass="calc-value" text="€0.00" GridPane.columnIndex="2" GridPane.rowIndex="1" />

                                <Separator styleClass="calc-separator" GridPane.columnIndex="0" GridPane.columnSpan="3" GridPane.rowIndex="2" />

                                <Label styleClass="calc-label-total" text="Differenza:" GridPane.columnIndex="0" GridPane.rowIndex="3" />
                                <Label fx:id="differenceLabel" styleClass="calc-value-total" text="€0.00" GridPane.columnIndex="2" GridPane.rowIndex="3" />
                            </children>
                        </GridPane>

                        <!-- Messaggio informativo -->
                        <VBox fx:id="differenceMessageContainer" spacing="8" styleClass="difference-message">
                            <Label fx:id="differenceMessageLabel" styleClass="difference-text" text="Seleziona i prodotti per calcolare la differenza" wrapText="true" />
                        </VBox>
                    </VBox>

                    <!-- Sezione azioni -->
                    <VBox spacing="15" styleClass="actions-section">
                        <Label styleClass="actions-title" text="📤 Conferma la Proposta" />

                        <HBox alignment="CENTER" spacing="20">
                            <Button fx:id="cancelExchangeButton" onAction="#cancelExchange" styleClass="cancel-exchange-button" text="Annulla Scambio" />
                            <Button fx:id="confirmExchangeButton" onAction="#confirmExchange" styleClass="confirm-exchange-button" text="Invia Proposta" />
                        </HBox>

                        <!-- Note aggiuntive -->
                        <VBox spacing="5" styleClass="exchange-notes">
                            <Label styleClass="note-title" text="📝 Note:" />
                            <Label styleClass="note-text" text="• La proposta verrà inviata al proprietario del prodotto desiderato" />
                            <Label styleClass="note-text" text="• Potrai modificare o annullare la proposta fino alla sua accettazione" />
                            <Label styleClass="note-text" text="• In caso di differenza di valore, sarà necessario un pagamento aggiuntivo" />
                        </VBox>
                    </VBox>
                </children>
            </VBox>
        </ScrollPane>
    </center>
</BorderPane>
